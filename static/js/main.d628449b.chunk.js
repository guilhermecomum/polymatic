(this.webpackJsonpPolymatic=this.webpackJsonpPolymatic||[]).push([[0],Array(73).concat([function(e,t,a){e.exports=a.p+"static/media/agogo1.1065034e.wav"},function(e,t,a){e.exports=a.p+"static/media/agogo2.0e4e658f.wav"},function(e,t,a){e.exports=a.p+"static/media/caxixi.f6ddaabb.wav"},function(e,t,a){e.exports=a.p+"static/media/kick1.d96070b8.wav"},function(e,t,a){e.exports=a.p+"static/media/snare.ac6ee711.wav"},function(e,t,a){e.exports=a.p+"static/media/surdo1.4c11d5fa.wav"},function(e,t,a){e.exports=a.p+"static/media/surdo2.de3c5a5c.wav"},function(e,t,a){e.exports=a.p+"static/media/surdo3.d327f3d9.wav"},function(e,t,a){e.exports=a.p+"static/media/surdo4.5e1800e9.wav"},function(e,t,a){e.exports=a.p+"static/media/tamborim1.a6cbfb58.wav"},function(e,t,a){e.exports=a.p+"static/media/tamborim2.06bd97bb.wav"},function(e,t,a){e.exports=a.p+"static/media/block1.d9f8c3a9.wav"},function(e,t,a){e.exports=a.p+"static/media/block2.7e7a9a59.wav"},function(e,t,a){e.exports=a.p+"static/media/conga1.41b2f57f.wav"},function(e,t,a){e.exports=a.p+"static/media/conga2.5cc86b71.wav"},function(e,t,a){e.exports=a.p+"static/media/conga3.435be93f.wav"},function(e,t,a){e.exports=a.p+"static/media/conga4.a38157fd.wav"},function(e,t,a){e.exports=a.p+"static/media/cowbell.566cddac.wav"},function(e,t,a){e.exports=a.p+"static/media/egg1.cedb0f6a.wav"},function(e,t,a){e.exports=a.p+"static/media/egg2.714c0889.wav"},function(e,t,a){e.exports=a.p+"static/media/xequere1.c6ac1d9b.wav"},function(e,t,a){e.exports=a.p+"static/media/xequere2.0e563d7a.wav"},function(e,t,a){e.exports=a.p+"static/media/clap.7bdee98b.wav"},function(e,t,a){e.exports=a.p+"static/media/hat.f03a8f48.wav"},function(e,t,a){e.exports=a.p+"static/media/kick1.9621794a.wav"},function(e,t,a){e.exports=a.p+"static/media/kik2.c392cef6.wav"},function(e,t,a){e.exports=a.p+"static/media/kik3.557e0210.wav"},function(e,t,a){e.exports=a.p+"static/media/snare.4707aa1f.wav"},function(e,t,a){e.exports=a.p+"static/media/bass.b2419d4f.wav"},function(e,t,a){e.exports=a.p+"static/media/block.3753c44b.wav"},function(e,t,a){e.exports=a.p+"static/media/bum.4c11d5fa.wav"},function(e,t,a){e.exports=a.p+"static/media/claves.400c9ef3.wav"},function(e,t,a){e.exports=a.p+"static/media/cymbal.950d832b.wav"},function(e,t,a){e.exports=a.p+"static/media/djembe1.f3e648cb.wav"},function(e,t,a){e.exports=a.p+"static/media/djembe3.acef368f.wav"},function(e,t,a){e.exports=a.p+"static/media/djembe2.d38ab3d2.wav"},function(e,t,a){e.exports=a.p+"static/media/hit.a315148b.wav"},function(e,t,a){e.exports=a.p+"static/media/hithat.950d832b.wav"},function(e,t,a){e.exports=a.p+"static/media/kick2.18445a5e.wav"},function(e,t,a){e.exports=a.p+"static/media/kicklow.c09eab14.wav"},function(e,t,a){e.exports=a.p+"static/media/tamborim.a6cbfb58.wav"},,,,function(e){e.exports=JSON.parse('{"name":"Polymatic","version":"6.0.0","private":true,"homepage":"https://polymatic.ciberterreiro.org","dependencies":{"@fortawesome/fontawesome-svg-core":"^1.2.27","@fortawesome/free-brands-svg-icons":"^5.15.1","@fortawesome/free-solid-svg-icons":"^5.12.1","@fortawesome/react-fontawesome":"^0.1.9","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","bootstrap":"^4.4.1","euclidean-rhythms":"^2.0.1","gh-pages":"^2.2.0","react":"^16.13.0","react-bootstrap":"^1.0.0-beta.17","react-bootstrap-range-slider":"^0.3.1","react-dom":"^16.13.0","react-ga":"^2.7.0","react-router-dom":"^5.1.2","react-scripts":"3.4.0","sass":"^1.32.5","shortid":"^2.2.15","tone":"^14.7.58"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","predeploy":"npm run build","deploy":"gh-pages -b gh-pages -d build","staging":"npm run build && cp CI build/CNAME && gh-pages -b staging -o staging -d build"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"semantic-release":"^17.2.3"}}')},,function(e,t,a){e.exports=a(153)},,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(32),r=a.n(s),c=(a(124),a(3)),o=a(9),l=a(40),u=a(15),m=a(68);var p=function(){return i.a.createElement("div",{className:"about"},i.a.createElement("div",{className:"col-8 offset-2"},i.a.createElement("h3",null,"Polymatic!"),i.a.createElement("p",null,"projeto idealizado por Gil Amancio e Guilherme Guerra"),i.a.createElement("p",null,"O Polymatic \xe9 um aplicativo para fazer m\xfasica ou dar aula de m\xfasica a partir de outros paradigmas que orientam a cria\xe7\xe3o musical. Ele \xe9 inspirado nos modos de produ\xe7\xe3o da m\xfasica africana e da di\xe1spora. N\xe3o \xe9 um software para fazer m\xfasica no computador, mas sim, um aplicativo para fazer m\xfasica assistida por computador, ou seja, o computador \xe9 uma ferramenta para instigar a cria\xe7\xe3o e a execu\xe7\xe3o musical coletiva que acontece junto com o computador."),i.a.createElement("p",null,"O Polymatic \xe9 um aplicativo que gera padr\xf5es r\xedtmicos m\xednimos. Esses padr\xf5es t\xeam v\xe1rios nomes em diferentes lugares, clave em Cuba, timeline nos Estados Unidos e Europa, e no Brasil resolvi cham\xe1-los de Guia."),i.a.createElement("p",null,"A escolha do nome Guia veio da associa\xe7\xe3o dos registros desses padr\xf5es r\xedtmicos de forma circular, feito pelo m\xfasico Safi-alDin em Bagd\xe1 no ano de 1280, com as Guias usadas pelo povo dos terreiros."),i.a.createElement("p",null,"Do ponto de vista musical a guia \xe9 um ostinato, que se repete sem varia\xe7\xe3o, ao longo de uma pe\xe7a musical. Ela atua como um dispositivo estruturador da cria\xe7\xe3o musical, d\xe1 o tempero da levada e atua tamb\xe9m como um cron\xf4metro."),i.a.createElement("p",null,"Nos terreiros, a palavra guia tamb\xe9m tem v\xe1rios significados, ela pode se referir tanto ao colar utilizado pelas pessoas que frequentam o terreiro, como tamb\xe9m as entidades que s\xe3o chamadas de guias."),i.a.createElement("p",null,"Acredito que chamar de guia os padr\xf5es r\xedtmicos gerados pelo Polymatic, vai nos aproximar do pensamento das culturas dos povos africanos e das di\xe1sporas e de suas experi\xeancias coletivas de fazer m\xfasica. Uma m\xfasica que n\xe3o se separa da dan\xe7a e da vida."),i.a.createElement("p",null,"Esperamos que o Polymatic possa possibilitar que voc\xea re\xfana a fam\xedlia, as/os amigos/as e se for professor as/os estudantes para juntos fazerem m\xfasica a partir do pensamento musical africano e da di\xe1spora."),i.a.createElement("p",null,"Mas como isso acontece? Leia o nosso manual."),i.a.createElement("p",null,i.a.createElement("a",{href:"".concat("","/manual.pdf"),target:"_blank",rel:"noopener noreferrer"},"Baixar manual"))))},d=a(4),f=a.n(d),h=a(11),v=a(50),b=a.n(v),g=(a(70),a(17)),y=a.n(g),E=a(21),w=a(22),k=a(158),j=a(72),x=a(12),O={previewPattern:"",previewVisibility:!1,piano:{},samplers:{},polymetric:!1,claves:[],circle:!1,shareableLink:"",isPlaying:!1,instruments:null},P=Object(n.createContext)(O),q=function(e){var t=e.children,a=P.Provider,s=i.a.useCallback((function(e,t){switch(t.type){case"load.app":return Object(c.a)(Object(c.a)({},e),{},{samplers:t.samplers,instruments:t.instruments});case"load.piano":return Object(c.a)(Object(c.a)({},e),{},{piano:t.piano});case"previewPattern.update":return Object(c.a)(Object(c.a)({},e),{},{previewPattern:t.pattern});case"preview.visibility":return Object(c.a)(Object(c.a)({},e),{},{previewVisibility:t.visible});case"claves.add":return Object(c.a)(Object(c.a)({},e),{},{claves:[].concat(Object(x.a)(e.claves),[t.clave])});case"claves.remove":var a=e.claves.filter((function(e){return e.id!==t.id}));return Object(c.a)(Object(c.a)({},e),{},{claves:a,polymetric:a.length>0&&e.polymetric});case"claves.edit":var n=e.claves.findIndex((function(e){return e.id===t.id}));return e.claves[n]=t.clave,Object(c.a)({},e);case"claves.removeAll":return Object(c.a)(Object(c.a)({},e),{},{claves:[],polymetric:!1});case"claves.share":var i=e.claves.map((function(e){return{sequence:e.pattern.sequence.join(""),tempo:e.tempo,sample:e.instrument}}));return Object(c.a)(Object(c.a)({},e),{},{shareableLink:JSON.stringify(i)});case"circle.add":return Object(c.a)(Object(c.a)({},e),{},{circle:t.circle});case"circle.edit":return e.circles=t.circle,Object(c.a)({},e);case"toggle.polymetric":return Object(c.a)(Object(c.a)({},e),{},{polymetric:!e.polymetric});case"start.all":return Object(c.a)(Object(c.a)({},e),{},{isPlaying:!0});case"stop.all":return Object(c.a)(Object(c.a)({},e),{},{isPlaying:!1});default:throw new Error("C\xeas\xe1siessionibuspassnasavassi?")}}),[]),r=Object(n.useReducer)(s,O),l=Object(o.a)(r,2),u=l[0],m=l[1];return i.a.createElement(a,{value:{state:u,dispatch:m}},t)};P.Consumer;function C(e){var t=e.clave,a=Object(n.useRef)(),s=Object(n.useRef)(),r=t.pattern.sequence,c=t.clavis,l=t.instrument,u=t.bpm,m=t.activeStep,p=Object(n.useState)(0),d=Object(o.a)(p,2),f=d[0],h=d[1],v=Object(n.useState)(100),g=Object(o.a)(v,2),x=g[0],O=g[1],q=Object(n.useState)(u),C=Object(o.a)(q,2),N=C[0],S=C[1],A=Object(n.useState)(!1),B=Object(o.a)(A,2),I=B[0],z=B[1],R=Object(n.useContext)(P).dispatch,M=Object(n.useContext)(P).state;Object(n.useEffect)((function(){c.configure(a.current,r,N),c.play(),M.isPlaying&&t.start()}),[M.isPlaying,t,c,r,N,u]),Object(n.useEffect)((function(){s.current&&s.current.focus()}),[I]);return i.a.createElement("div",{className:"layer"},i.a.createElement("div",{className:"guia"},i.a.createElement("canvas",{id:y.a.generate(),ref:a,width:640,height:425}),i.a.createElement("div",{className:"tempo"},i.a.createElement("div",null,I?i.a.createElement("input",{ref:s,pattern:"[0-9]*",className:"tempoInput",onChange:function(e){return S(Number(e.target.value.replace(/\D/,"")))},onBlur:function(e){return a=Number(e.target.value.replace(/\D/,"")),t.setBpm(a),R({type:"claves.edit",id:t.id,clave:t}),void z(!1);var a},type:"text",value:N}):i.a.createElement("p",{className:"tempoInput",onClick:function(){return z(!0),void S(u)}},u),i.a.createElement("p",{className:"bpm"},"BPM")))),i.a.createElement("div",{className:"mt-2 volume"},i.a.createElement("span",{className:"mr-2"},"Rota\xe7\xe3o"),i.a.createElement(b.a,{value:f,min:1,max:r.join("").length,onChange:function(e){return a=Number(e.target.value),h(a),t.shift(a),void R({type:"claves.edit",id:t.id,clave:t});var a},tooltip:"off"})),i.a.createElement("ul",null,i.a.createElement("li",null,"padr\xe3o:",i.a.createElement("span",{className:"sequence"},r.map((function(e,t){return i.a.createElement("span",{className:t===m?"active":"",key:t},e)})))),i.a.createElement("li",null,"instrumento: ",l)),i.a.createElement("div",{className:"controls"},i.a.createElement(k.a,{"aria-label":"Basic example"},i.a.createElement(j.a,{onClick:function(){t.start()}},i.a.createElement(E.a,{icon:w.d})),i.a.createElement(j.a,{onClick:function(){t.stop()}},i.a.createElement(E.a,{icon:w.f})),i.a.createElement(j.a,{onClick:function(){return t.remove(),void R({type:"claves.remove",id:t.id})}},i.a.createElement(E.a,{icon:w.h})))),i.a.createElement("div",{className:"mt-2 volume"},i.a.createElement("span",{className:"mr-2"},"Vol."),i.a.createElement(b.a,{value:x,min:0,max:100,tooltipLabel:function(e){return"".concat(e,"%")},onChange:function(e){return a=Number(e.target.value),O(a),0===a?t.setVolume(-1e3):t.setVolume(.3*a-24),void R({type:"claves.edit",id:t.id,clave:t});var a}})))}var N=a(1),S=a(2),A=function(){function e(){Object(N.a)(this,e),this.canvas=null,this.context=null,this.pattern=null,this.tempo=0,this.animate=!1,this.lastRender=Date.now(),this.draw=this.draw.bind(this),this.currentStep=0,this.patternPos={}}return Object(S.a)(e,[{key:"configure",value:function(e,t,a){this.canvas=e,this.context=e.getContext("2d"),this.pattern=t,this.tempo=a}},{key:"setCurrentStep",value:function(e){this.currentStep=e}},{key:"play",value:function(){this.animate=!0,window.requestAnimationFrame(this.draw)}},{key:"pause",value:function(){this.animate=!1}},{key:"draw",value:function(){var e=this.canvas,t=this.context,a=this.pattern,n="20px",i=2,s="#fff",r="#cc2c11",c=4,l="#cc2c11",u="#cc2c11",m=2,p="#fff",d="#fff",f=8,h="#cc2c11",v="#cc2c11",b=[200,200],g=b[0],y=b[1],E=80,w=2*Math.PI/a.length,k=-.5*Math.PI;function j(e,a,n){var i=n.radius,s=n.stroke,r=n.fill;t.strokeStyle=s,t.fillStyle=r,t.beginPath(),t.arc(e,a,i,0,2*Math.PI),t.fill(),t.stroke()}function x(e,t){j(e,t,{radius:c,stroke:l,fill:u})}function O(e,t){j(e,t,{radius:m,stroke:p,fill:d})}e.style.padding=n,e.width=g,e.height=y,t.clearRect(0,0,g,y),t.lineWidth=i,t.strokeStyle=s,t.beginPath(),t.arc(g/2,y/2,E,0,2*Math.PI),t.stroke();var P=[];function q(e,t){return[Math.cos(e)*t+g/2,Math.sin(e)*t+y/2]}for(var C=0;C<a.length;C++){var N=q(k+w*C,E),S=Object(o.a)(N,2),A=S[0],B=S[1];"1"===a[C]?(x(A,B),P.push([A,B])):O(A,B),this.patternPos[C]={x:A,y:B}}P.length>=1&&function(e){t.strokeStyle=r,t.beginPath(),t.moveTo(e[0][0],e[0][1]);for(var a=1;a<e.length;a++)t.lineTo(e[a][0],e[a][1]);t.closePath(),t.stroke()}(P),function(e,t){j(e,t,{radius:f,stroke:h,fill:v})}(this.patternPos[this.currentStep].x,this.patternPos[this.currentStep].y),this.animate&&window.requestAnimationFrame(this.draw)}}]),e}();function B(){var e=new A,t=Object(n.useRef)(),a=Object(n.useContext)(P).state;return Object(n.useEffect)((function(){t.current&&(e.configure(t.current,a.previewPattern,120),e.draw())}),[a.previewPattern,e]),a.previewPattern&&0!==a.previewPattern.length?i.a.createElement("div",{className:"layer"},i.a.createElement("canvas",{id:y.a.generate(),ref:t,width:640,height:425}),i.a.createElement("p",{className:"Preview"},"Pr\xe9-visualiza\xe7\xe3o")):null}var I,z=a(13),R=a(57),M=a.n(R),D=a(73),T=a.n(D),F=a(74),V=a.n(F),G=a(75),L=a.n(G),J=a(76),U=a.n(J),W=a(77),H=a.n(W),$=a(78),_=a.n($),X=a(79),Y=a.n(X),K=a(80),Q=a.n(K),Z=a(81),ee=a.n(Z),te=a(82),ae=a.n(te),ne=a(83),ie=a.n(ne),se=a(84),re=a.n(se),ce=a(85),oe=a.n(ce),le=a(86),ue=a.n(le),me=a(87),pe=a.n(me),de=a(88),fe=a.n(de),he=a(89),ve=a.n(he),be=a(90),ge=a.n(be),ye=a(91),Ee=a.n(ye),we=a(92),ke=a.n(we),je=a(93),xe=a.n(je),Oe=a(94),Pe=a.n(Oe),qe=a(95),Ce=a.n(qe),Ne=a(96),Se=a.n(Ne),Ae=a(97),Be=a.n(Ae),Ie=a(98),ze=a.n(Ie),Re=a(99),Me=a.n(Re),De=a(100),Te=a.n(De),Fe=a(101),Ve=a.n(Fe),Ge=a(102),Le=a.n(Ge),Je=a(103),Ue=a.n(Je),We=a(104),He=a.n(We),$e=a(105),_e=a.n($e),Xe=a(106),Ye=a.n(Xe),Ke=a(107),Qe=a.n(Ke),Ze=a(108),et=a.n(Ze),tt=a(109),at=a.n(tt),nt=a(110),it=a.n(nt),st=a(111),rt=a.n(st),ct=a(112),ot=a.n(ct),lt=a(113),ut=a.n(lt),mt={agogo1:T.a,agogo2:V.a,caxixi:L.a,kick1:U.a,snare:H.a,surdo1:_.a,surdo2:Y.a,surdo3:Q.a,surdo4:ee.a,tamborim1:ae.a,tamborim2:ie.a,block1:re.a,block2:oe.a,conga1:ue.a,conga2:pe.a,conga3:fe.a,conga4:ve.a,cowbell:ge.a,egg1:Ee.a,egg2:ke.a,xequere1:xe.a,xequere2:Pe.a,eclap:Ce.a,ehat:Se.a,ekick1:Be.a,ekik2:ze.a,ekik3:Me.a,esnare:Te.a,bass:Ve.a,block:Le.a,bumbo:Ue.a,claves:He.a,cymbal:_e.a,djembe1:Ye.a,djembe2:Qe.a,djembe3:et.a,hit:at.a,hithat:it.a,kick2:rt.a,kicklow:ot.a,tamborim:ut.a},pt=a(24),dt=(I={},Object(pt.a)(I,y.a.generate(),{name:"Toque Ignbin",instruments:[{sequence:"101101011010",tempo:120,sample:"conga1"}]}),Object(pt.a)(I,y.a.generate(),{name:"Son cubano",instruments:[{sequence:"1001001000101000",tempo:92,sample:"claves"}]}),Object(pt.a)(I,y.a.generate(),{name:"Rumba",instruments:[{sequence:"1001000100101000",tempo:110,sample:"claves"}]}),Object(pt.a)(I,y.a.generate(),{name:"Samba",instruments:[{sequence:"1011010101101010",tempo:60,sample:"tamborim"}]}),I),ft=function(){function e(t,a){Object(N.a)(this,e),this.pulses=t,this.steps=a,this.sequence="",this.createSequence(t,a),this.offset=0}return Object(S.a)(e,[{key:"update",value:function(e,t){this.createSequence(e,t)}},{key:"shift",value:function(e){if(this.offset<e){for(var t=this.sequence.splice(this.sequence.length-1,1),a=0;a<t.length;a++)this.sequence.unshift(t[a]);this.pulses=this.sequence.join(""),this.steps=this.sequence.length}else{for(var n=this.sequence.splice(0,1),i=0;i<n.length;i++)this.sequence.push(n[i]);this.pulses=this.sequence.join(""),this.steps=this.sequence.length}return this.offset=e,this}},{key:"createSequence",value:function(e,t){var a=typeof e;"number"===a?(this.steps=t,this.sequence=M.a.getPattern(e,t),this.pulses=this.sequence.join("")):"string"===a&&(this.steps=e.length,this.sequence=e.split(""))}}]),e}(),ht=a(18),vt=function(){function e(t,a,n,i){var s=this,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5?arguments[5]:void 0;if(Object(N.a)(this,e),this.id=y.a.generate(),this.prevSequence=c,this.pattern=new ft(t),this.bpm=a,this.volume=0,this.polymetric=r,this.clavis=new A,this.size=this.pattern.sequence.length,this.instrument=n,this.sample=i,this.activeStep=null,this.context=new ht.b,this.channel=new ht.a({volume:this.volume,pan:0,context:this.context}),this.player=new ht.d({url:this.sample,context:this.context}),this.polymetric){var o=this.prevSequence.length,l=this.size;if(l!==o)if(o>l){var u=o/l;this.bpm=(this.bpm*u).toFixed(2)}else{var m=l/o;this.bpm=(this.bpm/m).toFixed(2)}}this.context.transport.bpm.value=this.bpm,this.indexArray=function(e){for(var t=[],a=0;a<e;a++)t.push(a);return t},this.tick=function(e,t){"1"===s.pattern.sequence[t]&&s.player.start(e).chain(s.channel,s.context.destination),s.context.draw.schedule((function(){s.clavis.setCurrentStep(t)}),e)},this.seq=new ht.f({context:this.context,callback:this.tick,events:this.indexArray(this.size),subdivision:"".concat(this.size,"n")}).start(0)}return Object(S.a)(e,[{key:"setVolume",value:function(e){this.volume=e,this.channel.set({volume:e})}},{key:"pattern",value:function(e,t){return new ft(e,t)}},{key:"shift",value:function(e){this.pattern=this.pattern.shift(e),this.clavis.draw()}},{key:"setActivestep",value:function(e){this.activeStep=e}},{key:"setBpm",value:function(e){this.bpm=e;var t=this.context.transport.now();this.context.transport.bpm.setValueAtTime(this.bpm,t)}},{key:"remove",value:function(){this.clavis.pause(),this.seq.dispose(),this.context.dispose(),this.channel.dispose()}},{key:"start",value:function(){ht.i(),this.context.transport.start(),this.seq.start(),this.clavis.play()}},{key:"stop",value:function(){this.context.transport.stop(),this.clavis.pause(),this.seq.stop()}},{key:"faster",value:function(){this.setBpm(this.bpm+1)}},{key:"slower",value:function(){this.bpm>=2?this.setBpm(this.bpm-1):this.setBpm(1)}}]),e}(),bt=a(162);function gt(e){var t=e.show,a=e.onHide,n=e.onConfirm;return i.a.createElement(bt.a,{show:t,onHide:a,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},i.a.createElement(bt.a.Header,{closeButton:!0},i.a.createElement(bt.a.Title,{id:"contained-modal-title-vcenter"},"Remover todas as guias?")),i.a.createElement(bt.a.Body,null,i.a.createElement("h4",null,"Aten\xe7\xe3o!"),i.a.createElement("p",null,"Voc\xea confirma que deseja apagar todas as guias?")),i.a.createElement(bt.a.Footer,null,i.a.createElement(j.a,{variant:"secondary",onClick:a},"Fechar"),i.a.createElement(j.a,{onClick:n},"Remover")))}var yt=a(159),Et=a(116),wt=a(163),kt=a(161);var jt=function(){var e=Object(u.f)(),t=Object(n.useState)(!1),a=Object(o.a)(t,2),s=a[0],r=a[1],c=Object(n.useState)("agogo1"),l=Object(o.a)(c,2),m=l[0],p=l[1],d=Object(n.useState)(120),f=Object(o.a)(d,2),h=f[0],v=f[1],b=Object(n.useContext)(P).dispatch,g=Object(n.useContext)(P).state,x=g.claves,O=g.previewPattern,q=g.polymetric,C=g.previewVisibility,N=g.shareableLink,S=g.samplers,A=Object(n.useState)(!1),B=Object(o.a)(A,2),I=B[0],R=B[1],D=x.length>0,T=Object(n.useRef)(null),F="";x.length>0&&(F=x[0].pattern.sequence.join(""));var V=function(){var e,t=Object(z.a)(x);try{for(t.s();!(e=t.n()).done;){e.value.stop()}}catch(a){t.e(a)}finally{t.f()}b({type:"stop.all",isPlaying:!0})},G=function(){!function(){var e,t=Object(z.a)(x);try{for(t.s();!(e=t.n()).done;){e.value.remove()}}catch(a){t.e(a)}finally{t.f()}b({type:"stop.all",isPlaying:!0})}(),b({type:"claves.removeAll"}),R(!1)};return i.a.createElement("div",{className:"toolbar"},i.a.createElement(gt,{show:I,onHide:function(){return R(!1)},onConfirm:function(){return G()}}),i.a.createElement("div",{className:"toolbar-controls"},i.a.createElement(k.a,{"aria-label":"Basic example"},i.a.createElement(j.a,{onClick:function(){return function(){var e,t=Object(z.a)(x);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.slower(),b({type:"claves.edit",id:a.id,clave:a})}}catch(n){t.e(n)}finally{t.f()}}()}},i.a.createElement(E.a,{icon:w.a})),i.a.createElement(j.a,{onClick:function(){return function(){var e,t=Object(z.a)(x);try{for(t.s();!(e=t.n()).done;){e.value.start()}}catch(a){t.e(a)}finally{t.f()}}()}},i.a.createElement(E.a,{icon:w.d})),i.a.createElement(j.a,{onClick:function(){return V()}},i.a.createElement(E.a,{icon:w.f})),i.a.createElement(j.a,{onClick:function(){return function(){var e,t=Object(z.a)(x);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.faster(),b({type:"claves.edit",id:a.id,clave:a})}}catch(n){t.e(n)}finally{t.f()}}()}},i.a.createElement(E.a,{icon:w.c})),i.a.createElement(j.a,{onClick:function(){return R(!0)},disabled:!D},i.a.createElement(E.a,{icon:w.g})))),i.a.createElement("div",{className:"toolbar-form"},i.a.createElement(yt.a,null,i.a.createElement(yt.a.Prepend,null,i.a.createElement(yt.a.Text,{id:"basic-addon3"},"Padr\xe3o")),i.a.createElement(Et.a,{placeholder:"1010101 ou 3,4",ref:T,onChange:function(e){return function(e){var t=new RegExp("^(\\d+),(\\d+)$"),a=new RegExp("^[0-1]{1,}$");if(t.test(e)){var n=e.split(",").map((function(e){return parseInt(e)})).sort((function(e,t){return e-t})),i=Object(o.a)(n,2),s=i[0],c=i[1],l=M.a.getPattern(s,c).join("");b({type:"previewPattern.update",pattern:l}),r(!1)}else a.test(e)?(b({type:"previewPattern.update",pattern:e}),r(!1)):r(!0);""===e&&(b({type:"previewPattern.update",pattern:e}),r(!1)),C||b({type:"preview.visibility",visible:!0})}(e.target.value)},isInvalid:s})),i.a.createElement(yt.a,null,i.a.createElement(yt.a.Prepend,null,i.a.createElement(yt.a.Text,{id:"basic-addon3"},"Tempo")),i.a.createElement(Et.a,{placeholder:"tempo",value:h,onChange:function(e){return v(Number(e.target.value))}})),i.a.createElement(yt.a,null,i.a.createElement(yt.a.Prepend,null,i.a.createElement(j.a,{onClick:function(){new ht.d({url:S.get(m)}).toDestination().start(0)}},i.a.createElement(E.a,{icon:w.d}))),i.a.createElement(wt.a.Control,{as:"select",onChange:function(e){return p(e.target.value)}},Object.keys(mt).map((function(e,t){return i.a.createElement("option",{key:t,value:e},e)})))),i.a.createElement(wt.a.Check,{inline:!0,className:"ml-2 polymetric",type:"checkbox",label:"Polimetria",checked:q,onChange:function(){return b({type:"toggle.polymetric"})},disabled:!D}),i.a.createElement(j.a,{className:"ml-2",onClick:function(){return function(){var e=new vt(O,h,m,S.get(m),q,F);b({type:"claves.add",id:y.a.generate(),clave:e}),b({type:"previewPattern.update",pattern:O}),b({type:"preview.visibility",visible:!1}),b({type:"start.all"})}()},disabled:s||0===O.length},"Adicionar"),i.a.createElement(kt.a,{className:"ml-2"},i.a.createElement(kt.a.Toggle,{variant:"info",id:"dropdown-basic"},"presets"),i.a.createElement(kt.a.Menu,null,Object.keys(dt).map((function(e,t){return i.a.createElement(kt.a.Item,{key:t,onClick:function(){return dt[e].instruments.forEach((function(e){var t=e.sequence,a=e.tempo,n=e.sample,i=new vt(t,a,n,S.get(n));b({type:"claves.add",id:y.a.generate(),clave:i})})),void b({type:"start.all"})}},dt[e].name)})))),i.a.createElement(j.a,{onClick:function(){return function(){var t=x.map((function(e){return{sequence:e.pattern.sequence.join(""),tempo:e.bpm,sample:e.instrument}})),a=JSON.stringify(t);a!==N&&(V(),b({type:"claves.share",shareableLink:a}),b({type:"claves.removeAll"}),e.push("/guias?guias=".concat(a)))}()},disabled:!D},i.a.createElement(E.a,{icon:w.e}))))};var xt=function(){var e=Object(n.useContext)(P),t=e.state,a=e.dispatch,s=new URLSearchParams(Object(u.g)().search).get("guias"),r=JSON.parse(s);return Object(n.useEffect)((function(){function e(){return(e=Object(h.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.forEach((function(e){var n=e.sequence,i=e.tempo,s=e.sample,r=new vt(n,i,s,t.samplers.get(s));return a({type:"claves.add",id:y.a.generate(),clave:r})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r&&function(t){e.apply(this,arguments)}(r)}),[s]),i.a.createElement("div",{className:"App"},i.a.createElement(jt,null),i.a.createElement("div",{className:"wrapper"},t.claves.map((function(e){return i.a.createElement(C,{key:e.id,clave:e})})),t.previewVisibility&&i.a.createElement(B,null)))},Ot=function(){function e(){Object(N.a)(this,e),this.canvas=null,this.context=null,this.pattern=null,this.tempo=0,this.animate=!1,this.lastRender=Date.now(),this.draw=this.draw.bind(this),this.currentStep=0,this.patternPos={},this.patternNotes=[],this.notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}return Object(S.a)(e,[{key:"configure",value:function(e,t,a){this.pattern=t,this.canvas=e,this.context=e.getContext("2d"),this.tempo=a}},{key:"setCurrentStep",value:function(e){this.currentStep=e}},{key:"play",value:function(){this.animate=!0,window.requestAnimationFrame(this.draw)}},{key:"pause",value:function(){this.animate=!1}},{key:"draw",value:function(){var e=this.canvas,t=this.context,a=this.pattern,n={"canvas-padding":"0px","canvas-width":600,"canvas-height":600,"notes-circle-radius":220,"outer-circle-radius":180,"outer-circle-line-width":0,"outer-circle-stroke-style":"#000","dot-path-stroke":"#cc2c11","dot-on-radius":4,"dot-on-stroke-style":"#cc2c11","dot-on-fill-style":"#cc2c11","dot-off-radius":2,"dot-off-stroke-style":"#fff","dot-off-fill-style":"#fff","dot-beat-radius":8,"dot-beat-stroke-style":"#cc2c11","dot-beat-fill-style":"#cc2c11"},i=[n["canvas-width"],n["canvas-height"]],s=i[0],r=i[1],c=n["outer-circle-radius"],l=2*Math.PI/a.length,u=-.5*Math.PI;function m(e,a,n){var i=new Path2D;return i.arc(e,a,20,0,2*Math.PI),t.fillStyle="#fff",t.fill(i),t.font="8pt sans",t.fillStyle="black",t.textAlign="center",t.font="15px serif",t.fillText(n,e,a+5),i}function p(e,a,n){var i=n.radius,s=n.stroke,r=n.fill;t.strokeStyle=s,t.fillStyle=r,t.beginPath(),t.arc(e,a,i,0,2*Math.PI),t.fill(),t.stroke()}function d(e,t){p(e,t,{radius:n["dot-on-radius"],stroke:n["dot-on-stroke-style"],fill:n["dot-on-fill-style"]})}function f(e,t){p(e,t,{radius:n["dot-off-radius"],stroke:n["dot-off-stroke-style"],fill:n["dot-off-fill-style"]})}e.style.padding=n["canvas-padding"],e.width=s,e.height=r,t.clearRect(0,0,s,r),t.lineWidth=n["outer-circle-line-width"],t.strokeStyle=n["outer-circle-stroke-style"],t.beginPath(),t.arc(s/2,r/2,c,0,2*Math.PI),t.stroke();var h=[],v=[];function b(e,t){return[Math.cos(e)*t+s/2,Math.sin(e)*t+r/2]}for(var g=0;g<a.length;g++){var y=u+l*g,E=b(y,c),w=Object(o.a)(E,2),k=w[0],j=w[1];"1"===a[g]?(d(k,j),h.push([k,j])):f(k,j);var x=b(y,n["notes-circle-radius"]),O=Object(o.a)(x,2),P=m(O[0],O[1],this.notes[g]);v.push(P),this.patternPos[g]={x:k,y:j},this.patternNotes[g]=P}h.length>=1&&function(e){t.strokeStyle=n["dot-path-stroke"],t.beginPath(),t.moveTo(e[0][0],e[0][1]);for(var a=1;a<e.length;a++)t.lineTo(e[a][0],e[a][1]);t.closePath(),t.stroke()}(h),function(e,t){p(e,t,{radius:n["dot-beat-radius"],stroke:n["dot-beat-stroke-style"],fill:n["dot-beat-fill-style"]})}(this.patternPos[this.currentStep].x,this.patternPos[this.currentStep].y),this.animate&&window.requestAnimationFrame(this.draw)}}]),e}(),Pt=function(){function e(t){var a=this;Object(N.a)(this,e),console.log("new Circle"),this.id=y.a.generate(),this.pattern=new ft("100010010000"),this.clavis=new Ot,this.size=this.pattern.sequence.length,this.piano=t,this.bpm=120,this.circleNotes=["C1","C#1","D1","D#1","E1","F1","F#1","G1","G#1","A1","A#1","B1"],ht.h.bpm.value=this.bpm,this.indexArray=function(e){for(var t=[],a=0;a<e;a++)t.push(a);return t},this.tick=function(e,t){"1"===a.pattern.sequence[t]&&a.piano.triggerAttackRelease(a.circleNotes[t],.25),ht.c.schedule((function(){a.clavis.setCurrentStep(t),a.clavis.draw()}),e)},this.seq=new ht.f({callback:this.tick,events:this.indexArray(this.size),subdivision:"".concat(this.size,"n")}).start(0)}return Object(S.a)(e,[{key:"shift",value:function(e){this.pattern=this.pattern.shift(e)}},{key:"setBpm",value:function(e){this.bpm=e;var t=ht.h.now();ht.h.bpm.setValueAtTime(this.bpm,t)}},{key:"updatePattern",value:function(e){this.pattern=new ft(e),this.size=this.pattern.sequence.length,this.clavis.draw()}},{key:"start",value:function(){console.log("start"),ht.i(),ht.h.start(),this.seq.start()}},{key:"stop",value:function(){ht.h.stop(),this.seq.stop()}}]),e}();function qt(e){var t=e.circle,a=Object(n.useRef)(),s=Object(n.useRef)(),r=t.pattern.sequence,c=t.clavis,l=t.bpm,u=Object(n.useState)(r),m=Object(o.a)(u,2),p=m[0],d=m[1],f=Object(n.useState)(0),h=Object(o.a)(f,2),v=h[0],g=h[1],x=Object(n.useState)(l),O=Object(o.a)(x,2),q=O[0],C=O[1],N=Object(n.useState)(!1),S=Object(o.a)(N,2),A=S[0],B=S[1],I=Object(n.useContext)(P).dispatch,z=Object(n.useContext)(P).state;Object(n.useEffect)((function(){c.configure(a.current,r,q),c.draw(),z.isPlaying&&t.start()}),[z.isPlaying,t,c,r,q,l,p]),Object(n.useEffect)((function(){s.current&&s.current.focus()}),[A]);return i.a.createElement("div",{className:"layer"},i.a.createElement("div",{className:"guia"},i.a.createElement("canvas",{id:y.a.generate(),ref:a,width:700,height:700,onClick:function(e){e.stopPropagation();var a=c.context;c.patternNotes.forEach((function(n,i){a.isPointInPath(n,e.nativeEvent.offsetX,e.nativeEvent.offsetY)?(a.fillStyle="green",a.lineWidth=4,a.strokeStyle="red",a.stroke(n),p[i]="1"===p[i]?"0":"1",d(p),t.updatePattern(p.join("")),I({type:"circle.edit",circle:t})):(a.strokeStyle="white",a.stroke(n))}))}}),i.a.createElement("div",{className:"tempo"},i.a.createElement("div",null,A?i.a.createElement("input",{ref:s,pattern:"[0-9]*",className:"tempoInput",onChange:function(e){return C(Number(e.target.value.replace(/\D/,"")))},onBlur:function(e){return a=Number(e.target.value.replace(/\D/,"")),console.log("value",a),t.setBpm(a),I({type:"circle.edit",circle:t}),void B(!1);var a},type:"text",value:q}):i.a.createElement("p",{className:"tempoInput",onClick:function(){return B(!0),void C(l)}},l),i.a.createElement("p",{className:"bpm"},"BPM")))),i.a.createElement("div",{className:"mt-2 volume"},i.a.createElement("span",{className:"mr-2"},"Rota\xe7\xe3o"),i.a.createElement(b.a,{value:v,min:1,max:r.join("").length,onChange:function(e){return a=Number(e.target.value),g(a),t.shift(a),void I({type:"circle.edit",id:t.id,circle:t});var a},tooltip:"off"})),i.a.createElement("div",{className:"controls"},i.a.createElement(k.a,{"aria-label":"Basic example"},i.a.createElement(j.a,{onClick:function(){t.start()}},i.a.createElement(E.a,{icon:w.d})),i.a.createElement(j.a,{onClick:function(){t.stop()}},i.a.createElement(E.a,{icon:w.f})))))}var Ct=function(){var e=Object(n.useContext)(P),t=e.state,a=e.dispatch;return Object(n.useEffect)((function(){var e=new Pt(t.piano);a({type:"circle.add",circle:e})}),[]),i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"circle-wrapper"},t.circle&&i.a.createElement(qt,{circle:t.circle})))},Nt=a(117),St=a(165),At=a(164),Bt=a(118);var It=function(){return i.a.createElement(St.a,{collapseOnSelect:!0,bg:"black",expand:"lg",variant:"black"},i.a.createElement(St.a.Brand,null,i.a.createElement("h3",null,i.a.createElement(l.b,{to:"/"},"Polymatic ",i.a.createElement("small",null,Nt.version)))),i.a.createElement(At.a,{className:"mr-auto"},i.a.createElement(At.a,null,i.a.createElement(l.b,{to:"/sobre"},"sobre"))),i.a.createElement(At.a,{className:"justify-content-end"},i.a.createElement(At.a.Link,{href:"mailto:polymatic@ciberterreiro.org"},i.a.createElement(E.a,{icon:w.b,className:"github",size:"2x"})),i.a.createElement(At.a.Link,{href:"https://github.com/guilhermecomum/polymatic",target:"_blank",rel:"noopener noreferrer"},i.a.createElement(E.a,{icon:Bt.a,className:"github",size:"2x"}))))},zt=(a(151),a(152),a(160));var Rt=function(){var e=Object(n.useState)(!0),t=Object(o.a)(e,2),a=t[0],s=t[1];m.a.initialize("UA-160360260-2"),m.a.pageview(window.location.pathname+window.location.search);var r=Object(n.useContext)(P).dispatch;return Object(n.useEffect)((function(){var e=new ht.g({urls:Object(c.a)({},mt),onload:function(){return s(!1)}});r({type:"load.app",samplers:e});var t=new ht.e({urls:{A1:"A1.mp3",A2:"A2.mp3"},baseUrl:"https://tonejs.github.io/audio/casio/",onload:function(){return s(!1)}}).toDestination();r({type:"load.piano",piano:t})}),[r]),a?i.a.createElement(zt.a,{animation:"border",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading...")):i.a.createElement(l.a,{basename:"/"},i.a.createElement(It,null),i.a.createElement(u.c,null,i.a.createElement(u.a,{exact:!0,path:"/",component:xt}),i.a.createElement(u.a,{exact:!0,path:"/sobre",component:p}),i.a.createElement(u.a,{exact:!0,path:"/guias",component:xt}),i.a.createElement(u.a,{exact:!0,path:"/circle",component:Ct})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(q,null,i.a.createElement(Rt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}]),[[119,1,2]]]);
//# sourceMappingURL=main.d628449b.chunk.js.map